/*
jQWidgets v11.0.1 (2020-Dec)
Copyright (c) 2011-2020 jQWidgets.
License: https://jqwidgets.com/license/
*/
/* eslint-disable */

(function(b){b.extend(b.jqx._jqxGrid.prototype,{_exportData:function(R,L,I){var Z=this;var P=typeof L==="string"?L:L.fileName;if(!P){P="jqxGrid"}if(!L||typeof L==="string"){L={header:true,filterBy:null,groupBy:null,style:null,fileName:P,pageOrientation:"portrait",expandChart:"+",collapseChar:"-"}}var ag=new b.jqx.dataAdapter.DataExporter({exportHeader:L.header});var V=[];ag.expandChar=L.expandChar;ag.collapseChar=L.collapseChar;ag.pageOrientation=L.pageOrientation;ag.style=L.style;ag.filterBy=L.filterBy;ag.groupBy=L.groupBy;var N=[];var X=Z.columngroups||[];var aa=0;for(var W=0;W<Z.columns.records.length;W++){var af=Z.columns.records[W];if(!af.exportable){continue}if(Z.columns.records[W].datafield!==null){N[aa++]={label:Z.columns.records[W].text,dataField:Z.columns.records[W].datafield}}}ag.header={columns:N,columngroups:X};if(!L.style){var ac=window.getComputedStyle(Z.element);var J=window.getComputedStyle(Z.columns.records.length>0&&Z.columns.records[0].element?Z.columns.records[0].element:Z.host.find(".jqx-grid-header")[0]);var j=window.getComputedStyle(Z.host.find(".jqx-grid-header")[0]);var ad=Z.offsetWidth===0||Z.offsetHeight===0;if(!ad){var ae=function(h){var g="Helvetica";var e=h.fontSize;var m=h.borderRightColor;var f=h.backgroundColor;var k=h.color;var d=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");var l=function(n){return isNaN(n)?"00":d[(n-n%16)/16]+d[n%16]};var c=function(r){if(r.toString().indexOf("rgba")!=-1){var t=k.split(",");var p=parseInt(t[0].substring(5));var q=parseInt(t[1]);var u=parseInt(t[2]);var s=parseFloat(t[3].substring(1,4));var o={r:p,g:q,b:u};var n=Z._rgbToHex(o);if(p==0&&q==0&&u==0&&s==0){return"#ffffff"}return"#"+n}r=r.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);if(!r){return"#ffffff"}return"#"+l(r[1])+l(r[2])+l(r[3]).toUpperCase()};return{borderColor:c(m),fontSize:e,fontFamily:g,color:c(k),backgroundColor:c(f)}};var T=ae(ac);var Y=ae(J);var O=ae(j);var a={height:"30px",border:"1px solid "+T.borderColor,fontFamily:O.fontFamily,fontSize:O.fontSize,color:O.color,backgroundColor:Y.backgroundColor,fontWeight:"400"};var ai={border:"1px solid "+T.borderColor,fontFamily:T.fontFamily,fontSize:T.fontSize};var Q={height:Z.rowsheight+"px"};for(var W=0;W<Z.columns.records.length;W++){var af=Z.columns.records[W];if(!af.exportable){continue}a[af.datafield]={textAlign:af.align,width:af.width+"px",format:af.cellsformat||""};var aj=af.cellsformat||"";if(af.dataType==="date"){aj="d"}else{if(af.dataType==="dateTime"){aj="D"}else{if(af.dataType==="time"){aj="t"}}}var U={textAlign:af.cellsalign,format:aj};ai[af.datafield]=U}if(Z.altrows){Q.alternationCount=2;Q.alternationStart=0;Q.alternationEnd=0;Q.alternationIndex0Color=T.color;Q.alternationIndex0BackgroundColor=T.backgroundColor;Q.alternationIndex1Color=T.color;Q.alternationIndex1BackgroundColor="#F5F5F5"}ag.style={border:"1px solid "+T.borderColor,borderCollapse:"collapse",header:a,columns:ai,rows:Q}}}var ah=I||this.getrows();var M=[];for(var W=0;W<ah.length;W++){var ab=ah[W];if(ab.hidden){continue}var K={};for(var i=0;i<Z.columns.records.length;i++){var af=Z.columns.records[i];if(!af.exportable){continue}K[af.datafield]=ab[af.datafield]}M.push(K)}if(!L.groupBy&&Z.groups){ag.groupBy=Z.groups.slice(0)}var S=ag.exportData(M,R,L.fileName,null);return S},exportview:function(h,a,f){var g=this;g._exportData(h,a,f)},exportdata:function(Z,ab,ac,ad,X,T,al){if(!b.jqx.dataAdapter.ArrayExporter){throw"jqxGrid: Missing reference to jqxdata.export.js!"}if(Z==="xlsx"){this._exportData("xlsx",ab);return}if(ac==undefined){ac=true}var a=this;if(ad==undefined){var ad=this.getrows();if(ad.length==0){throw"No data to export."}}this.exporting=true;if(!this.pageable){this.loadondemand=true}if(this.altrows){this._renderrows(this.virtualsizeinfo)}var ae=this.hScrollInstance.value;this.hScrollInstance.setPosition(0);this._renderrows(this.virtualsizeinfo);var M=X!=undefined?X:false;var R={};var af={};var P=[];var ah=this.host.find(".jqx-grid-cell:first");var N=this.host.find(".jqx-grid-cell-alt:first");ah.removeClass(this.toThemeProperty("jqx-grid-cell-selected"));ah.removeClass(this.toThemeProperty("jqx-fill-state-pressed"));N.removeClass(this.toThemeProperty("jqx-grid-cell-selected"));N.removeClass(this.toThemeProperty("jqx-fill-state-pressed"));ah.removeClass(this.toThemeProperty("jqx-grid-cell-hover"));ah.removeClass(this.toThemeProperty("jqx-fill-state-hover"));N.removeClass(this.toThemeProperty("jqx-grid-cell-hover"));N.removeClass(this.toThemeProperty("jqx-fill-state-hover"));var ak="cell";var am=1;var O="column";var ao=1;var aj=[];for(var W=0;W<this.columns.records.length;W++){var an=this.columns.records[W];if(an.cellclassname!=""){an.customCellStyles=new Array();if(typeof an.cellclassname=="string"){for(var V=0;V<ad.length;V++){an.customCellStyles[V]=an.cellclassname}}else{for(var V=0;V<ad.length;V++){var Q=this.getrowboundindex(V);var ap=an.cellclassname(Q,an.displayfield,ad[V][an.displayfield],ad[V]);if(ap){an.customCellStyles[V]=ap}}}}}var j=new Array();var i=null;var aq=null;var ar=null;b.each(this.columns.records,function(l){var d=b(a.table[0].rows[0].cells[l]);if(a.table[0].rows.length>1){var e=b(a.table[0].rows[1].cells[l]);if(!ar){ar=e}}if(!aq){aq=d}var m=this;var k=function(p){p.removeClass(a.toThemeProperty("jqx-grid-cell-selected"));p.removeClass(a.toThemeProperty("jqx-fill-state-pressed"));p.removeClass(a.toThemeProperty("jqx-grid-cell-hover"));p.removeClass(a.toThemeProperty("jqx-fill-state-hover"));if(m.customCellStyles){for(var o in m.customCellStyles){p.removeClass(m.customCellStyles[o])}}};k(d);if(e){k(e)}if(this.displayfield==null){return true}if(a.showaggregates){if(a.getcolumnaggregateddata){aj.push(a.getcolumnaggregateddata(this.displayfield,this.aggregates,true,ad))}}var g=a._getexportcolumntype(this);if(this.exportable&&(!this.hidden||M)){R[this.displayfield]={};R[this.displayfield].text=this.text;R[this.displayfield].width=parseInt(this.width);if(isNaN(R[this.displayfield].width)){R[this.displayfield].width=60}R[this.displayfield].formatString=this.cellsformat;R[this.displayfield].localization=a.gridlocalization;R[this.displayfield].type=g;R[this.displayfield].cellsAlign=this.cellsalign;R[this.displayfield].hidden=!ac;R[this.displayfield].displayfield=this.displayfield;j.push(R[this.displayfield])}ak="cell"+am;var c=b(this.element);if(this.element==undefined){c=b(this.uielement)}if(!i){i=c}else{if(!m._rendered){c=i;d=aq;e=ar;var h=a.toTP("jqx-grid-cell")+" "+a.toTP("jqx-item");d[0].className=h;h+=a.toTP("jqx-grid-cell-alt");if(e){e[0].className=h}}}O="column"+ao;if(Z=="html"||Z=="xls"||Z=="pdf"){var f=function(u,v,w,t,o,r,s,q,p){af[u]={};if(v==undefined){return}if(v[0].offsetWidth==0||v[0].offsetHeight==0){if(!w){af[u]["dataType"]=g}return}af[u]["font-size"]=v.css("font-size");af[u]["font-weight"]=v.css("font-weight");af[u]["font-style"]=v.css("font-style");af[u]["background-color"]=r._getexportcolor(v.css("background-color"));af[u]["color"]=r._getexportcolor(v.css("color"));af[u]["border-color"]=r._getexportcolor(v.css("border-top-color"));if(w){af[u]["text-align"]=o.align}else{af[u]["text-align"]=o.cellsalign;af[u]["formatString"]=o.cellsformat;af[u]["dataType"]=g}if(Z=="html"||Z=="pdf"){af[u]["border-top-width"]=v.css("border-top-width");af[u]["border-left-width"]=v.css("border-left-width");af[u]["border-right-width"]=v.css("border-right-width");af[u]["border-bottom-width"]=v.css("border-bottom-width");af[u]["border-top-style"]=v.css("border-top-style");af[u]["border-left-style"]=v.css(